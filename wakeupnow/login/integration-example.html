<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WAKE UP NOW - IntegraÃ§Ã£o React</title>
    
    <!-- CSS Global -->
    <link rel="stylesheet" href="../style.css">
    <link rel="stylesheet" href="login.css">
    
    <!-- React CDN (Desenvolvimento) -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
</head>
<body>
    <div id="root">
        <div id="viewLogin" class="view"></div>
    </div>

    <script type="module">
        /**
         * EXEMPLO: IntegraÃ§Ã£o do componente Login React com roteador vanilla
         * 
         * Este exemplo mostra como:
         * 1. Montar o componente React
         * 2. Executar callback quando login bem-sucedido
         * 3. Integrar com localStorage e contexto de autenticaÃ§Ã£o
         */

        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        // 1. IMPORTAR COMPONENTE
        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

        import { mountLoginComponent, unmountLoginComponent } from './mount-login.js';

        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        // 2. DEFINIR CONTEXTO DE AUTENTICAÃ‡ÃƒO GLOBAL
        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

        window.AuthContext = {
            userData: null,
            userToken: null,

            /**
             * Carrega dados do usuÃ¡rio e token do localStorage
             */
            init() {
                const storedToken = localStorage.getItem('userToken');
                const storedUser = localStorage.getItem('userData');

                if (storedToken && storedUser) {
                    this.userToken = storedToken;
                    this.userData = JSON.parse(storedUser);
                    return true;
                }
                return false;
            },

            /**
             * Salva autenticaÃ§Ã£o apÃ³s login bem-sucedido
             */
            setAuth(userData, token) {
                this.userData = userData;
                this.userToken = token;
                localStorage.setItem('userData', JSON.stringify(userData));
                localStorage.setItem('userToken', token);
                console.log('âœ… AutenticaÃ§Ã£o armazenada:', userData.email);
            },

            /**
             * Limpa autenticaÃ§Ã£o ao fazer logout
             */
            clear() {
                this.userData = null;
                this.userToken = null;
                localStorage.removeItem('userData');
                localStorage.removeItem('userToken');
                console.log('âŒ AutenticaÃ§Ã£o removida');
            },

            /**
             * Verifica se usuÃ¡rio estÃ¡ autenticado
             */
            isAuthenticated() {
                return !!(this.userToken && this.userData);
            }
        };

        // Carregar dados salvos
        AuthContext.init();

        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        // 3. GERENCIADOR DE ROTEAMENTO
        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

        window.Router = {
            currentView: 'login',

            /**
             * Navega para uma view especÃ­fica
             */
            navigateTo(viewName) {
                console.log(`ğŸ”„ Navegando para: ${viewName}`);
                this.currentView = viewName;

                // Limpar view anterior
                const viewElement = document.querySelector('.view.active');
                if (viewElement) {
                    viewElement.classList.remove('active');
                    unmountLoginComponent(); // Limpar React se necessÃ¡rio
                }

                // Carregar nova view baseado no nome
                this.loadView(viewName);
            },

            /**
             * Carrega view especÃ­fica
             */
            loadView(viewName) {
                const viewElement = document.getElementById(`view${this.capitalizeFirst(viewName)}`);

                if (!viewElement) {
                    console.error(`View ${viewName} nÃ£o encontrada`);
                    return;
                }

                viewElement.classList.add('active');

                // Montar componentes especÃ­ficos
                if (viewName === 'login') {
                    this.loadLoginView();
                } else if (viewName === 'home') {
                    this.loadHomeView();
                }
            },

            /**
             * Carrega view de LOGIN
             */
            loadLoginView() {
                const handleLoginSuccess = (userData) => {
                    // âœ… UsuÃ¡rio fez login com sucesso
                    AuthContext.setAuth(userData, userData.token);

                    // Mostrar feedback
                    console.log('âœ… Login bem-sucedido:', userData.name);

                    // Redirecionar para home apÃ³s 1 segundo
                    setTimeout(() => {
                        this.navigateTo('home');
                    }, 1000);
                };

                // Montar componente React na view
                mountLoginComponent('viewLogin', handleLoginSuccess);
            },

            /**
             * Carrega view de HOME
             */
            loadHomeView() {
                if (!AuthContext.isAuthenticated()) {
                    console.log('âš ï¸ Acesso negado. Redirecionando para login...');
                    this.navigateTo('login');
                    return;
                }

                // Renderizar conteÃºdo da home
                const viewElement = document.getElementById('viewHome');
                if (viewElement) {
                    viewElement.innerHTML = `
                        <div class="container">
                            <h1>Bem-vindo, ${AuthContext.userData.name}!</h1>
                            <p>E-mail: ${AuthContext.userData.email}</p>
                            <button onclick="localStorage.clear(); location.reload()">Logout</button>
                        </div>
                    `;
                }
            },

            /**
             * Auxiliar para capitalizar primeira letra
             */
            capitalizeFirst(str) {
                return str.charAt(0).toUpperCase() + str.slice(1);
            }
        };

        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        // 4. INICIALIZAR ROTEADOR
        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

        // Determinar view inicial
        const initialView = AuthContext.isAuthenticated() ? 'home' : 'login';
        Router.navigateTo(initialView);

        // Expor Router globalmente para uso em onclick handlers
        window.Router = Router;
        window.AuthContext = AuthContext;
    </script>

    <style>
        /* Adicionar estilos para views */
        .view {
            display: none;
            animation: fadeIn 0.3s ease-in;
        }

        .view.active {
            display: block;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
            }
            to {
                opacity: 1;
            }
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
    </style>
</body>
</html>

<!-- 
    EXEMPLOS DE USO:
    
    1. NAVEGAR PROGRAMATICAMENTE:
    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    Router.navigateTo('login');
    Router.navigateTo('home');
    
    2. VERIFICAR SE AUTENTICADO:
    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    if (AuthContext.isAuthenticated()) {
        console.log('UsuÃ¡rio logado:', AuthContext.userData.email);
    }
    
    3. FAZER LOGOUT:
    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    AuthContext.clear();
    Router.navigateTo('login');
    
    4. OBTER TOKEN PARA REQUISIÃ‡Ã•ES:
    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    const headers = {
        'Authorization': `Bearer ${AuthContext.userToken}`
    };
    
    5. REDIRECIONAMENTO CONDICIONAL NO HTML:
    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    <button onclick="
        if (AuthContext.isAuthenticated()) {
            Router.navigateTo('home');
        } else {
            Router.navigateTo('login');
        }
    ">Acessar</button>
-->
