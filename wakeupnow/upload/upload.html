<!-- upload/upload.html -->
<!-- Responsabilidade: √Årea de upload de v√≠deos para administradores -->

<div class="view" id="view-upload">

  <div class="section-heading">
    <h1>Upload de V√≠deos</h1>
    <p>Fa√ßa o upload de novos conte√∫dos e vincule-os a temas e m√≥dulos existentes.</p>
  </div>

  <div class="upload-layout">

    <!-- LEFT: Upload Form -->
    <div class="upload-main">

      <!-- DROP ZONE -->
      <div class="card upload-dropzone" id="dropzone">
        <div class="dropzone-inner" id="dropzoneInner">
          <div class="dropzone-icon">üé¨</div>
          <h3 class="dropzone-title">Arraste o v√≠deo aqui</h3>
          <p class="dropzone-sub">ou clique para selecionar um arquivo</p>
          <p class="dropzone-hint">Formatos suportados: MP4, MOV, AVI, MKV ¬∑ M√°x. 4GB</p>
          <button class="btn btn-outline mt-4" onclick="document.getElementById('fileInput').click()">
            üìÇ Selecionar Arquivo
          </button>
          <input type="file" id="fileInput" accept="video/*" style="display:none" onchange="handleFileSelect(this)">
        </div>

        <!-- Preview state (hidden initially) -->
        <div class="dropzone-preview" id="dropzonePreview" style="display:none">
          <div class="video-preview-thumb">
            <video id="videoPreview" controls style="width:100%;border-radius:8px;"></video>
          </div>
          <div class="preview-meta" id="previewMeta"></div>
          <button class="btn btn-ghost btn-sm mt-2" onclick="clearFile()">‚úï Remover arquivo</button>
        </div>
      </div>

      <!-- PROGRESS BAR (hidden until uploading) -->
      <div class="upload-progress-wrap" id="uploadProgressWrap" style="display:none">
        <div class="upload-progress-bar">
          <div class="upload-progress-fill" id="uploadProgressFill"></div>
        </div>
        <div class="upload-progress-label">
          <span id="uploadProgressPct">0%</span>
          <span id="uploadProgressStatus">Enviando...</span>
        </div>
      </div>

      <!-- FORM DETAILS -->
      <div class="card mt-6">
        <div class="card-header">
          <span class="card-title">Informa√ß√µes do V√≠deo</span>
        </div>

        <div class="form-group">
          <label class="form-label">T√≠tulo do V√≠deo <span class="required">*</span></label>
          <input type="text" class="form-input" id="videoTitle" placeholder="Ex: Introdu√ß√£o ao M√≥dulo 1">
        </div>

        <div class="form-group">
          <label class="form-label">Descri√ß√£o</label>
          <textarea class="form-textarea" id="videoDesc" placeholder="Descreva o conte√∫do deste v√≠deo..."></textarea>
        </div>

        <div class="form-row">
          <div class="form-group" style="margin-bottom:0">
            <label class="form-label">Tema <span class="required">*</span></label>
            <select class="form-select" id="videoTheme" onchange="loadModulesForTheme(this.value)">
              <option value="">Selecionar tema...</option>
              <option value="1">Mentalidade e Mindset</option>
              <option value="2">Produtividade</option>
              <option value="3">Finan√ßas Pessoais</option>
              <option value="4">Lideran√ßa</option>
              <option value="5">Sa√∫de e Bem-estar</option>
            </select>
          </div>
          <div class="form-group" style="margin-bottom:0">
            <label class="form-label">M√≥dulo <span class="required">*</span></label>
            <select class="form-select" id="videoModule">
              <option value="">Selecione um tema primeiro...</option>
            </select>
          </div>
        </div>

        <div class="form-row mt-4">
          <div class="form-group" style="margin-bottom:0">
            <label class="form-label">Ordem no M√≥dulo</label>
            <input type="number" class="form-input" id="videoOrder" value="1" min="1">
            <p class="form-hint">Posi√ß√£o do v√≠deo dentro do m√≥dulo selecionado.</p>
          </div>
          <div class="form-group" style="margin-bottom:0">
            <label class="form-label">Visibilidade</label>
            <select class="form-select" id="videoVisibility">
              <option value="public">üåê P√∫blico (todos os planos)</option>
              <option value="pro">‚≠ê Pro e Elite</option>
              <option value="elite">üëë Somente Elite</option>
            </select>
          </div>
        </div>

        <div class="form-group mt-4">
          <label class="form-label">Thumbnail (Miniatura)</label>
          <div class="thumb-upload" onclick="document.getElementById('thumbInput').click()">
            <img id="thumbPreview" style="display:none; width:100%;border-radius:6px;" alt="thumbnail">
            <div id="thumbPlaceholder">
              <span>üñº</span>
              <p>Clique para adicionar thumbnail</p>
              <small>JPG, PNG ¬∑ Recomendado: 1280√ó720px</small>
            </div>
          </div>
          <input type="file" id="thumbInput" accept="image/*" style="display:none" onchange="handleThumb(this)">
        </div>

        <div class="flex gap-3 mt-2">
          <button class="btn btn-primary" onclick="submitUpload()" id="btnUpload" disabled>
            ‚¨Ü Enviar V√≠deo
          </button>
          <button class="btn btn-ghost" onclick="clearUploadForm()">Limpar</button>
        </div>
      </div>
    </div>

    <!-- RIGHT: Recent Uploads -->
    <div class="upload-sidebar">
      <div class="card">
        <div class="card-header">
          <span class="card-title">Uploads Recentes</span>
          <span class="tag tag-silver" id="uploadCount">0 v√≠deos</span>
        </div>

        <div class="recent-uploads-list" id="recentUploadsList">
          <div class="empty-state-sm">
            <p>Nenhum v√≠deo enviado ainda.</p>
          </div>
        </div>
      </div>

      <div class="card mt-4">
        <div class="card-header">
          <span class="card-title">Estat√≠sticas</span>
        </div>
        <div class="upload-stats">
          <div class="upload-stat">
            <strong id="stat-total-videos">0</strong>
            <span>V√≠deos cadastrados</span>
          </div>
          <div class="upload-stat">
            <strong id="stat-total-themes">5</strong>
            <span>Temas ativos</span>
          </div>
          <div class="upload-stat">
            <strong id="stat-storage">0 MB</strong>
            <span>Armazenamento usado</span>
          </div>
        </div>
      </div>
    </div>

  </div>
</div>
